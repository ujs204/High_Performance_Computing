
Here is the information of my processor. I am running on the NYU cims server.

Architecture:          x86_64
CPU op-mode(s):        32-bit, 64-bit
Byte Order:            Little Endian
CPU(s):                4
On-line CPU(s) list:   0-3
Thread(s) per core:    1
Core(s) per socket:    1
Socket(s):             4
NUMA node(s):          1
Vendor ID:             AuthenticAMD
CPU family:            23
Model:                 1
Model name:            AMD EPYC Processor (with IBPB)
Stepping:              2
CPU MHz:               2894.562
BogoMIPS:              5789.12
Hypervisor vendor:     KVM
Virtualization type:   full
L1d cache:             32K
L1i cache:             64K
L2 cache:              512K
L3 cache:              8192K

1. Ordering of the loops

We find that the ordering of the loops is n - > k -> m and m - > n -> k. This could be due to the fact that the matrices are structured in column major order (the consecutive elements of a column are stored next to each other). In regards to the n -> k -> m loop, each column j of B in the outer loop can be stored in the cache while we iterate over the rows of A. This results in nk read operations from B. Although there must be n*k*m reads in A, for each k columns we iterate over m rows such that there are only k*n memory transactions. The other loops require more reads and larger memory transactions (e.g. m*n*k reads). 

BLOCK_SIZE = 4

Dimension       Time    Gflop/s       GB/s        Error
         4   0.404147   4.948691  19.794764 0.000000e+00
        52   0.404722   4.941686  19.766744 0.000000e+00
       100   0.405225   4.940462  19.761847 0.000000e+00
       148   0.405377   4.942133  19.768533 0.000000e+00
       196   0.406346   4.928944  19.715776 0.000000e+00
       244   0.408611   4.906118  19.624474 0.000000e+00
       292   0.415689   4.911267  19.645068 0.000000e+00
       340   0.419458   4.872494  19.489978 0.000000e+00
       388   0.432317   4.864021  19.456085 0.000000e+00
       436   0.446182   4.829706  19.318823 0.000000e+00
       484   0.424673   4.805672  19.222686 0.000000e+00
       532   0.436651   4.827572  19.310286 0.000000e+00
       580   0.487625   4.801528  19.206112 0.000000e+00
       628   0.514453   4.814302  19.257208 0.000000e+00
       676   0.515162   4.797183  19.188733 0.000000e+00
       724   0.473590   4.808003  19.232011 0.000000e+00
       772   0.567759   4.862270  19.449079 0.000000e+00
       820   0.454185   4.855888  19.423553 0.000000e+00
       868   0.538947   4.853700  19.414798 0.000000e+00
       916   0.631733   4.866459  19.465836 0.000000e+00
       964   0.734218   4.880519  19.522076 0.000000e+00
      1012   0.424132   4.887313  19.549250 0.000000e+00
      1060   0.503840   4.727757  18.911029 0.000000e+00
      1108   0.559244   4.864608  19.458433 0.000000e+00
      1156   0.636555   4.853642  19.414570 0.000000e+00
      1204   0.725120   4.813929  19.255718 0.000000e+00
      1252   0.810834   4.840733  19.362933 0.000000e+00
      1300   0.915865   4.797650  19.190599 0.000000e+00
      1348   1.022931   4.789093  19.156370 0.000000e+00
      1396   1.133423   4.800584  19.202338 0.000000e+00
      1444   1.256380   4.793036  19.172144 0.000000e+00
      1492   1.387359   4.787927  19.151709 0.000000e+00
      1540   1.539041   4.746157  18.984628 0.000000e+00
      1588   1.697986   4.716798  18.867192 0.000000e+00
      1636   1.851466   4.730033  18.920133 0.000000e+00
      1684   2.013898   4.742624  18.970498 0.000000e+00
      1732   2.184539   4.756789  19.027156 0.000000e+00
      1780   2.387630   4.724143  18.896572 0.000000e+00
      1828   2.558371   4.775238  19.100951 0.000000e+00
      1876   2.758551   4.786824  19.147297 0.000000e+00
      1924   2.989733   4.764451  19.057804 0.000000e+00
      1972   3.212414   4.774405  19.097620 0.000000e+00


BLOCK_SIZE = 8

Dimension       Time    Gflop/s       GB/s        Error
         8   0.303106   6.598362  13.196724 0.000000e+00
        56   0.304278   6.573806  13.147612 0.000000e+00
       104   0.305204   6.553012  13.106024 0.000000e+00
       152   0.304294   6.578274  13.156547 0.000000e+00
       200   0.308563   6.533519  13.067038 0.000000e+00
       248   0.307512   6.547371  13.094742 0.000000e+00
       296   0.309563   6.534628  13.069255 0.000000e+00
       344   0.313528   6.491860  12.983720 0.000000e+00
       392   0.313838   6.525759  13.051518 0.000000e+00
       440   0.313318   6.525061  13.050123 0.000000e+00
       488   0.320471   6.527437  13.054874 0.000000e+00
       536   0.332437   6.485040  12.970081 0.000000e+00
       584   0.365736   6.535097  13.070194 0.000000e+00
       632   0.322114   6.269490  12.538981 0.000000e+00
       680   0.387250   6.495682  12.991365 0.000000e+00
       728   0.364085   6.358328  12.716655 0.000000e+00
       776   0.440244   6.368589  12.737179 0.000000e+00
       824   0.344376   6.498432  12.996865 0.000000e+00
       872   0.405186   6.545687  13.091374 0.000000e+00
       920   0.478015   6.516006  13.032013 0.000000e+00
       968   0.555011   6.537092  13.074184 0.000000e+00
      1016   0.321615   6.521914  13.043828 0.000000e+00
      1064   0.367533   6.554782  13.109565 0.000000e+00
      1112   0.420881   6.534089  13.068179 0.000000e+00
      1160   0.476320   6.553987  13.107974 0.000000e+00
      1208   0.539094   6.539826  13.079651 0.000000e+00
      1256   0.606595   6.532808  13.065615 0.000000e+00
      1304   0.680752   6.514390  13.028781 0.000000e+00
      1352   0.757352   6.526229  13.052459 0.000000e+00
      1400   0.844107   6.501547  13.003093 0.000000e+00
      1448   0.936483   6.483894  12.967787 0.000000e+00
      1496   1.030499   6.497960  12.995919 0.000000e+00
      1544   1.139712   6.459169  12.918338 0.000000e+00
      1592   1.243183   6.491190  12.982379 0.000000e+00
      1640   1.360719   6.483253  12.966506 0.000000e+00
      1688   1.490023   6.455864  12.911729 0.000000e+00
      1736   1.723845   6.069891  12.139782 0.000000e+00
      1784   1.758840   6.456367  12.912734 0.000000e+00
      1832   1.901956   6.465558  12.931116 0.000000e+00
      1880   2.074721   6.405364  12.810727 0.000000e+00
      1928   2.223234   6.447122  12.894244 0.000000e+00
      1976   2.424485   6.364604  12.729208 0.000000e+00

BLOCK_SIZE = 16

Dimension       Time    Gflop/s       GB/s        Error
        16   0.384481   5.201824   5.201824 0.000000e+00
        64   0.386230   5.178671   5.178671 0.000000e+00
       112   0.390136   5.128002   5.128002 0.000000e+00
       160   0.389712   5.150066   5.150066 0.000000e+00
       208   0.398794   5.054627   5.054627 0.000000e+00
       256   0.418000   4.816423   4.816423 0.000000e+00
       304   0.394416   5.128597   5.128597 0.000000e+00
       352   0.390686   5.135206   5.135206 0.000000e+00
       400   0.402360   5.089975   5.089975 0.000000e+00
       448   0.423925   5.090445   5.090445 0.000000e+00
       496   0.430678   5.099938   5.099938 0.000000e+00
       544   0.444756   5.067604   5.067604 0.000000e+00
       592   0.404850   5.124732   5.124732 0.000000e+00
       640   0.409534   5.120825   5.120825 0.000000e+00
       688   0.508075   5.127756   5.127756 0.000000e+00
       736   0.467763   5.113974   5.113974 0.000000e+00
       784   0.564920   5.118144   5.118144 0.000000e+00
       832   0.451161   5.106208   5.106208 0.000000e+00
       880   0.536944   5.076671   5.076671 0.000000e+00
       928   0.627858   5.091459   5.091459 0.000000e+00
       976   0.729706   5.096375   5.096375 0.000000e+00
      1024   0.477112   4.501004   4.501004 0.000000e+00
      1072   0.487628   5.052723   5.052723 0.000000e+00
      1120   0.557633   5.038896   5.038896 0.000000e+00
      1168   0.633026   5.034273   5.034273 0.000000e+00
      1216   0.711116   5.056972   5.056972 0.000000e+00
      1264   0.802211   5.034801   5.034801 0.000000e+00
      1312   0.898150   5.029010   5.029010 0.000000e+00
      1360   1.003494   5.013394   5.013394 0.000000e+00
      1408   1.123181   4.970366   4.970366 0.000000e+00
      1456   1.294168   4.770056   4.770056 0.000000e+00
      1504   1.386049   4.909022   4.909022 0.000000e+00
      1552   1.560861   4.790060   4.790060 0.000000e+00
      1600   1.675179   4.890222   4.890222 0.000000e+00
      1648   1.833811   4.881430   4.881430 0.000000e+00
      1696   2.020419   4.829098   4.829098 0.000000e+00
      1744   2.188490   4.847580   4.847580 0.000000e+00
      1792   2.578429   4.463637   4.463637 0.000000e+00
      1840   2.553193   4.879776   4.879776 0.000000e+00
      1888   2.754955   4.885640   4.885640 0.000000e+00
      1936   2.977450   4.874181   4.874181 0.000000e+00
      1984   3.203027   4.876345   4.876345 0.000000e+00




BLOCK_SIZE = 32

Dimension       Time    Gflop/s       GB/s        Error
        32   0.399295   5.008900   2.504450 0.000000e+00
        64   0.395125   5.062087   2.531044 0.000000e+00
        96   0.387411   5.165759   2.582879 0.000000e+00
       128   0.385787   5.185985   2.592992 0.000000e+00
       160   0.379387   5.290221   2.645111 0.000000e+00
       192   0.378488   5.310924   2.655462 0.000000e+00
       224   0.402170   4.974562   2.487281 0.000000e+00
       256   0.404933   4.971847   2.485924 0.000000e+00
       288   0.392346   5.114315   2.557158 0.000000e+00
       320   0.401697   5.057584   2.528792 0.000000e+00
       352   0.402323   4.986670   2.493335 0.000000e+00
       384   0.399978   5.096364   2.548182 0.000000e+00
       416   0.392235   5.139158   2.569579 0.000000e+00
       448   0.426507   5.059639   2.529820 0.000000e+00
       480   0.433760   5.099225   2.549612 0.000000e+00
       512   0.422853   5.078557   2.539278 0.000000e+00
       544   0.438798   5.136418   2.568209 0.000000e+00
       576   0.446981   5.130495   2.565247 0.000000e+00
       608   0.436947   5.143776   2.571888 0.000000e+00
       640   0.408966   5.127933   2.563966 0.000000e+00
       672   0.479700   5.060900   2.530450 0.000000e+00
       704   0.414683   5.048394   2.524197 0.000000e+00
       736   0.467202   5.120116   2.560058 0.000000e+00
       768   0.529645   5.131572   2.565786 0.000000e+00
       800   0.392802   5.213817   2.606908 0.000000e+00
       832   0.456102   5.050891   2.525445 0.000000e+00
       864   0.502883   5.130203   2.565102 0.000000e+00
       896   0.563162   5.109173   2.554586 0.000000e+00
       928   0.640209   4.993238   2.496619 0.000000e+00
       960   0.698939   5.063311   2.531656 0.000000e+00
       992   0.771958   5.058264   2.529132 0.000000e+00
      1024   0.425647   5.045222   2.522611 0.000000e+00
      1056   0.461820   5.099753   2.549877 0.000000e+00
      1088   0.504117   5.109585   2.554792 0.000000e+00
      1120   0.548492   5.122876   2.561438 0.000000e+00
      1152   0.598078   5.112457   2.556229 0.000000e+00
      1184   0.647814   5.124299   2.562150 0.000000e+00
      1216   0.713028   5.043408   2.521704 0.000000e+00
      1248   0.748592   5.193122   2.596561 0.000000e+00
      1280   0.822352   5.100378   2.550189 0.000000e+00
      1312   0.884238   5.108132   2.554066 0.000000e+00
      1344   0.966904   5.021629   2.510814 0.000000e+00
      1376   1.027178   5.072705   2.536352 0.000000e+00
      1408   1.100192   5.074220   2.537110 0.000000e+00
      1440   1.158095   5.156718   2.578359 0.000000e+00
      1472   1.240877   5.140727   2.570363 0.000000e+00
      1504   1.361917   4.996005   2.498003 0.000000e+00
      1536   1.432683   5.058869   2.529434 0.000000e+00
      1568   1.567568   4.918604   2.459302 0.000000e+00
      1600   1.776443   4.611463   2.305731 0.000000e+00
      1632   1.819823   4.777066   2.388533 0.000000e+00
      1664   1.974530   4.666875   2.333437 0.000000e+00
      1696   1.928573   5.059079   2.529539 0.000000e+00
      1728   2.076257   4.970272   2.485136 0.000000e+00
      1760   2.371748   4.597265   2.298633 0.000000e+00
      1792   2.496481   4.610157   2.305079 0.000000e+00
      1824   2.500353   4.854038   2.427019 0.000000e+00
      1856   2.598728   4.920430   2.460215 0.000000e+00
      1888   2.770466   4.858287   2.429143 0.000000e+00
      1920   2.798199   5.058888   2.529444 0.000000e+00
      1952   3.008905   4.943801   2.471900 0.000000e+00
      1984   3.196355   4.886524   2.443262 0.000000e+00



BLOCK_SIZE = 64


Dimension       Time    Gflop/s       GB/s        Error
        64   0.213119   9.385179   2.346295 0.000000e+00
       128   0.220928   9.055800   2.263950 0.000000e+00
       192   0.219262   9.167678   2.291919 0.000000e+00
       256   0.227720   8.840984   2.210246 0.000000e+00
       320   0.224242   9.059917   2.264979 0.000000e+00
       384   0.230914   8.827673   2.206918 0.000000e+00
       448   0.239589   9.006962   2.251740 0.000000e+00
       512   0.263960   8.135647   2.033912 0.000000e+00
       576   0.279659   8.200107   2.050027 0.000000e+00
       640   0.259937   8.067933   2.016983 0.000000e+00
       704   0.255504   8.193529   2.048382 0.000000e+00
       768   0.331656   8.194970   2.048742 0.000000e+00
       832   0.284802   8.088851   2.022213 0.000000e+00
       896   0.353945   8.129212   2.032303 0.000000e+00
       960   0.434005   8.154164   2.038541 0.000000e+00
      1024   0.270551   7.937439   1.984360 0.000000e+00
      1088   0.315760   8.157543   2.039386 0.000000e+00
      1152   0.378875   8.070339   2.017585 0.000000e+00
      1216   0.446185   8.059651   2.014913 0.000000e+00
      1280   0.524033   8.003887   2.000972 0.000000e+00
      1344   0.608539   7.978833   1.994708 0.000000e+00
      1408   0.727232   7.676528   1.919132 0.000000e+00
      1472   0.844805   7.550867   1.887717 0.000000e+00
      1536   0.933799   7.761578   1.940395 0.000000e+00
      1600   1.029991   7.953470   1.988367 0.000000e+00
      1664   1.178535   7.818935   1.954734 0.000000e+00
      1728   1.342754   7.685367   1.921342 0.000000e+00
      1792   1.517130   7.586145   1.896536 0.000000e+00
      1856   1.620033   7.892965   1.973241 0.000000e+00
      1920   1.810759   7.817591   1.954398 0.000000e+00
      1984   1.975681   7.905661   1.976415 0.000000e+00



BLOCK_SIZE = 128

Dimension       Time    Gflop/s       GB/s        Error
       128   0.324241   6.170356   0.771294 0.000000e+00
       256   0.326650   6.163370   0.770421 0.000000e+00
       384   0.338738   6.017719   0.752215 0.000000e+00
       512   0.376120   5.709573   0.713697 0.000000e+00
       640   0.345119   6.076613   0.759577 0.000000e+00
       768   0.449682   6.044072   0.755509 0.000000e+00
       896   0.476208   6.042093   0.755262 0.000000e+00
      1024   0.381267   5.632487   0.704061 0.000000e+00
      1152   0.515327   5.933410   0.741676 0.000000e+00
      1280   0.704094   5.957025   0.744628 0.000000e+00
      1408   0.925764   6.030284   0.753785 0.000000e+00
      1536   1.298351   5.582278   0.697785 0.000000e+00
      1664   1.523055   6.050265   0.756283 0.000000e+00
      1792   1.912752   6.017075   0.752134 0.000000e+00
      1920   2.412947   5.866592   0.733324 0.000000e+00



BLOCK_SIZE = 256

Dimension       Time    Gflop/s       GB/s        Error
       256   0.229362   8.777679   0.548605 0.000000e+00
       512   0.270565   7.937048   0.496065 0.000000e+00
       768   0.347720   7.816363   0.488523 0.000000e+00
      1024   0.277559   7.737022   0.483564 0.000000e+00
      1280   0.542365   7.733354   0.483335 0.000000e+00
      1536   0.933380   7.765065   0.485317 0.000000e+00
      1792   1.480007   7.776430   0.486027 0.000000e+00





The Optimal Block Size is 64. After 64, the performance with regards to the flops begins to decrease and become more variable. 


Given that the clock speed can be obtained from the following command:

[ujs204@access1 homework2]$ cat /proc/cpuinfo | grep Hz
cpu MHz         : 2894.562
cpu MHz         : 2894.562
cpu MHz         : 2894.562
cpu MHz         : 2894.562


This translates to 2.9 GHz * 4 = 11.6

9.385/11.6 = 0.809 = 80.9% peak FLOP rate. 




